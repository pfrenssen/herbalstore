<?xml version="1.0"?>
<ruleset name="Herbalstore">
  <description>Custom coding standard.</description>

  <file>web/modules/custom</file>
  <file>web/themes/custom</file>

  <!-- Set extensions to scan (taken from Coder 8.3.6). -->
  <!-- @see https://git.drupalcode.org/project/coder/blob/8.3.6/coder_sniffer/Drupal/ruleset.xml#L8 -->
  <arg name="extensions" value="php,inc,module,install,profile,theme"/>

  <arg name="report" value="full"/>

  <!-- Use colors in output. -->
  <arg name="colors"/>

  <!-- Show progress. -->
  <arg value="p"/>

  <!-- Run in parallel. -->
  <arg name="parallel" value="10"/>

  <arg name="basepath" value="/var/www/html/"/>

  <!-- Output logs wide enough so important information is not truncated. -->
  <arg name="report-width" value="180"/>

  <!-- Include existing standards. -->
  <rule ref="Drupal">
    <!-- Splitting up long arrays makes code less readable. https://www.drupal.org/node/3185082 -->
    <exclude name="Drupal.Arrays.Array.LongLineDeclaration"/>
    <!-- URLs in deprecation messages point to Jira tickets rather than drupal.org. -->
    <exclude name="Drupal.Semantics.FunctionTriggerError.TriggerErrorSeeUrlFormat" />
    <exclude name="Drupal.Commenting.Deprecated.DeprecatedWrongSeeUrlFormat" />
    <!-- Deprecation versions are following the release tags in Jira rather than the drupal.org versioning format 9.x-1.0. -->
    <exclude name="Drupal.Semantics.FunctionTriggerError.TriggerErrorVersion" />
    <!-- We do not specify a target removal version for deprecation messages. -->
    <exclude name="Drupal.Semantics.FunctionTriggerError.TriggerErrorTextLayoutRelaxed" />
    <exclude name="Drupal.Commenting.Deprecated.IncorrectTextLayout" />
  </rule>

  <rule ref="DrupalPractice"/>

  <rule ref="PHPCompatibility"/>
  <config name="testVersion" value="8.3"/>

  <!-- Require strict types declaration in every PHP file. -->
  <!-- @see https://www.drupal.org/project/coder/issues/3473534 -->
  <rule ref="SlevomatCodingStandard.TypeHints.DeclareStrictTypes.DeclareStrictTypesMissing">
    <severity>5</severity>
  </rule>

  <!-- Require nullable types to be declared as such. -->
  <rule ref="SlevomatCodingStandard.TypeHints.NullableTypeForNullDefaultValue" />

  <!-- Forbid annotations which are not included in the Drupal coding standard but are often added by IDEs. -->
  <rule ref="SlevomatCodingStandard.Commenting.ForbiddenAnnotations">
    <properties>
      <property name="forbiddenAnnotations" type="array">
        <element value="@author"/>
        <element value="@created"/>
        <element value="@copyright"/>
        <element value="@license"/>
        <element value="@package"/>
        <element value="@version"/>
      </property>
    </properties>
  </rule>

  <!-- Forbid documentation auto-generated by IDEs which does not align with the Drupal documentation standards. -->
  <rule ref="SlevomatCodingStandard.Commenting.ForbiddenComments">
    <properties>
      <property name="forbiddenCommentPatterns" type="array">
        <element value="/@inheritDoc/"/>
        <element value="/^Class [a-zA-z]*\.$/"/>
        <element value="/^Interface [a-zA-z]*\.$/"/>
        <element value="/^[a-zA-Z]* constructor\.$/"/>
        <element value="/^Constructor\.$/"/>
      </property>
    </properties>
  </rule>

  <!-- Enforce correct formatting of return types hints. -->
  <rule ref="SlevomatCodingStandard.TypeHints.ReturnTypeHintSpacing"/>

  <!-- Use statements should be ordered alphabetically. -->
  <rule ref="SlevomatCodingStandard.Namespaces.AlphabeticallySortedUses">
    <properties>
      <property name="caseSensitive" value="true"/>
    </properties>
  </rule>

  <!-- Require constructor property promotion. -->
  <rule ref="SlevomatCodingStandard.Classes.RequireConstructorPropertyPromotion"/>

</ruleset>
